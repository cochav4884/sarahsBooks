<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Book Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles/index.css" />
</head>
<body>

<!-- NAV -->
<header class="nav">
  <div class="nav-brand">ðŸ“š Book Tracker</div>
  <button class="hamburger" id="hamburger">â˜°</button>
  <nav id="navMenu">
    <button>1</button>
    <button>2</button>
    <button>3</button>
    <button>4</button>
    <button>5</button>
    <button>6</button>
  </nav>
</header>

<!-- JUMBOTRON -->
<section class="jumbotron">
  <img src="author-placeholder.jpg" alt="Author" />
  <div>
    <h1>Welcome!</h1>
    <p>Track every book from idea to publication.</p>
  </div>
</section>

<!-- MAIN -->
<main>
  <div class="controls">
    <button id="addCard">âž• Add Book</button>
    <button id="resetAll">ðŸ”„ Reset All</button>
  </div>

  <section id="cardsContainer"></section>
</main>

<script>
/* STORAGE */
const STORAGE_KEY = "bookCards";

/* DEFAULT CARD */
function createEmptyCard() {
  return {
    title: "",
    stages: [false, false, false, false, false],
    startDate: "",
    publishDate: "",
    copyrightDate: ""
  };
}

function defaultCards() {
  return Array.from({ length: 12 }, () => createEmptyCard());
}

/* LOAD/SAVE */
function loadCards() {
  const data = localStorage.getItem(STORAGE_KEY);
  return data ? JSON.parse(data) : defaultCards();
}

function saveCards(cards) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(cards));
}

/* RENDER CARDS */
function renderCards() {
  const container = document.getElementById("cardsContainer");
  container.innerHTML = "";
  const cards = loadCards();

  cards.forEach((card, index) => {
    const cardEl = document.createElement("div");
    cardEl.className = "book-card";

    cardEl.innerHTML = `
      <!-- TITLE -->
      <a href="book.html" class="book-link">
        <input
          class="title"
          placeholder="Book Title"
          value="${card.title}"
          readonly
        />
      </a>

      <!-- STAGES -->
      <div class="stages">
        ${["Planning","Rough Draft","Second Draft","Final Draft","Published"]
          .map((stage, i) => `
            <label>
              <input type="checkbox" ${card.stages[i] ? "checked" : ""}>
              ${stage}
            </label>
          `).join("")}
      </div>

      <!-- DATES -->
      <div class="dates">
        <label>
          Start Date
          <input type="date" value="${card.startDate}" />
        </label>
        <label>
          Published
          <input type="date" value="${card.publishDate}" />
        </label>
        <label>
          Copyright
          <input type="date" value="${card.copyrightDate}" />
        </label>
      </div>

      <button class="reset-card">Reset This Book</button>
    `;

    /* TITLE EDIT */
    const titleInput = cardEl.querySelector(".title");
    titleInput.addEventListener("dblclick", () => {
      titleInput.removeAttribute("readonly");
      titleInput.focus();
    });
    titleInput.addEventListener("blur", () => {
      titleInput.setAttribute("readonly", true);
      cards[index].title = titleInput.value;
      saveCards(cards);
    });

    /* STAGES */
    cardEl.querySelectorAll(".stages input").forEach((box, i) => {
      box.addEventListener("change", e => {
        cards[index].stages[i] = e.target.checked;
        saveCards(cards);
      });
    });

    /* DATES */
    const dateInputs = cardEl.querySelectorAll(".dates input");
    dateInputs[0].addEventListener("change", e => cards[index].startDate = e.target.value);
    dateInputs[1].addEventListener("change", e => cards[index].publishDate = e.target.value);
    dateInputs[2].addEventListener("change", e => cards[index].copyrightDate = e.target.value);
    dateInputs.forEach(input => input.addEventListener("change", () => saveCards(cards)));

    /* RESET CARD */
    cardEl.querySelector(".reset-card").addEventListener("click", () => {
      cards[index] = createEmptyCard();
      saveCards(cards);
      renderCards();
    });

    container.appendChild(cardEl);
  });
}

/* BUTTONS */
document.getElementById("addCard").onclick = () => {
  const cards = loadCards();
  cards.push(createEmptyCard());
  saveCards(cards);
  renderCards();
};
document.getElementById("resetAll").onclick = () => {
  localStorage.removeItem(STORAGE_KEY);
  renderCards();
};

/* HAMBURGER */
document.getElementById("hamburger").onclick = () => {
  document.getElementById("navMenu").classList.toggle("show");
};

/* INIT */
renderCards();
</script>

</body>
</html>
