<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Book Tracker</title>

  <link rel="icon" type="image/png" href="public/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="public/favicon.svg" />
  <link rel="shortcut icon" href="public/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="public/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="Book Tracker" />
  <link rel="manifest" href="public/site.webmanifest" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles/index.css" />
</head>
<body>

<header class="nav">
  <a href="index.html" class="logo-link">
    <img src="images/logo.jpg" alt="Logo" class="nav-logo" />
    <span class="nav-brand">ğŸ“š Book Tracker</span>
  </a>
</header>

<section class="jumbotron">
  <img src="images/authorImage.jpg" alt="Author" />
  <div>
    <h1>Author: Sarah Winter Shaw</h1>
    <h3>Self-Published</h3>
    <p>Track every book from planning to publication.</p>
  </div>
</section>

<main>
  <section id="cardsContainer"></section>

  <div class="controls">
    <button type="button" id="addCard">â• Add Book</button>
    <button type="button" id="resetAll">ğŸ”„ Reset All</button>
  </div>
</main>

  <!-- Footer -->
 <footer class="site-footer">
  <p>&copy; 2026 Sarah. All rights reserved.</p>
  <p>
    <a href="privacyPolicy.html">ğŸ”’ Privacy Policy</a> |
    <a href="legalDisclaimer.html">ğŸ“„ Legal Disclaimer</a>
  </p>
</footer>

<script>
const STORAGE_KEY = "bookCards";
const STAGES = ["Planning", "Rough Draft", "Second Draft", "Final Draft", "Completed"];

// ---------- CARD MODEL ----------
function createEmptyCard() {
  return {
    title: "",
    stages: Array(5).fill(false),
    googleDoc: "",
    startDate: "",
    completedDate: "",
    publishDate: "",
    copyrightDate: ""
  };
}

// ---------- STORAGE ----------
function loadCards() {
  return JSON.parse(localStorage.getItem(STORAGE_KEY) || "[]");
}

function saveCards(cards) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(cards));
}

// ---------- RENDER ----------
function renderCards() {
  const container = document.getElementById("cardsContainer");
  container.innerHTML = "";

  let cards = loadCards();
  if (cards.length === 0) {
    cards.push(createEmptyCard());
    saveCards(cards);
  }

  cards.forEach((card, index) => {
    const cardEl = document.createElement("div");
    cardEl.className = "book-card collapsed";

    cardEl.innerHTML = `
      <div class="title-container">
        <input class="title" placeholder="Book Title" value="${card.title}">
        <button class="btn delete">ğŸ—‘ï¸ Delete</button>
      </div>

      <div class="card-content">
        <div class="stages">
          ${STAGES.map((s,i)=>`
            <label>
              <input type="checkbox" ${card.stages[i] ? "checked" : ""} data-stage="${i}">
              ${s}
            </label>
          `).join("")}
        </div>

        <div class="completed-link" style="display:${card.stages[4] ? "block" : "none"}">
          <label>
            Google Docs Link (Completed Book)
            <input type="url" placeholder="Paste Google Docs link"
              value="${card.googleDoc}">
          </label>
        </div>

        <div class="dates">
          <label>Start <input type="date" value="${card.startDate}"></label>
          <label>Completed <input type="date" value="${card.completedDate}"></label>
          <label>Published <input type="date" value="${card.publishDate}"></label>
          <label>Copyright <input type="date" value="${card.copyrightDate}"></label>
        </div>

        <div class="card-actions">
          <button class="btn read-book" ${card.stages[4] ? "" : "style='display:none'"}>ğŸ“– Read Book</button>
          <button class="btn reset">ğŸ”„ Reset</button>
        </div>
      </div>
    `;

    // Accordion
    cardEl.querySelector(".title-container").onclick = e => {
      if (e.target.classList.contains("delete")) return;
      document.querySelectorAll(".book-card").forEach(c => c.classList.add("collapsed"));
      cardEl.classList.toggle("collapsed");
    };

    // Title
    cardEl.querySelector(".title").oninput = e => {
      cards[index].title = e.target.value;
      saveCards(cards);
    };

    // Delete
    cardEl.querySelector(".delete").onclick = () => {
      if (confirm("Delete this book?")) {
        cards.splice(index, 1);
        saveCards(cards);
        renderCards();
      }
    };

    // Stages
    cardEl.querySelectorAll(".stages input").forEach(box => {
      box.onchange = e => {
        const stage = +e.target.dataset.stage;
        cards[index].stages[stage] = e.target.checked;

        const linkBox = cardEl.querySelector(".completed-link");
        const readBtn = cardEl.querySelector(".read-book");

        if (stage === 4) {
          linkBox.style.display = e.target.checked ? "block" : "none";
          readBtn.style.display = e.target.checked ? "inline-block" : "none";
          if (e.target.checked) {
            cards[index].completedDate ||= new Date().toISOString().slice(0,10);
          }
        }
        saveCards(cards);
      };
    });

    // Google Doc
    cardEl.querySelector(".completed-link input").oninput = e => {
      cards[index].googleDoc = e.target.value;
      saveCards(cards);
    };

    // Dates
    const d = cardEl.querySelectorAll(".dates input");
    d[0].onchange = e => cards[index].startDate = e.target.value;
    d[1].onchange = e => cards[index].completedDate = e.target.value;
    d[2].onchange = e => cards[index].publishDate = e.target.value;
    d[3].onchange = e => cards[index].copyrightDate = e.target.value;

    // Read Book
    cardEl.querySelector(".read-book").onclick = () => {
      if (!card.googleDoc) {
        alert("Please paste a Google Docs link first.");
        return;
      }
      localStorage.setItem("activeBookIndex", index);
      window.location.href = "book.html";
    };

    // Reset
    cardEl.querySelector(".reset").onclick = () => {
      cards[index] = createEmptyCard();
      saveCards(cards);
      renderCards();
    };

    container.appendChild(cardEl);
  });
}

// Buttons
document.getElementById("addCard").onclick = () => {
  const cards = loadCards();
  cards.push(createEmptyCard());
  saveCards(cards);
  renderCards();
};

document.getElementById("resetAll").onclick = () => {
  if (confirm("Reset all books?")) {
    localStorage.removeItem(STORAGE_KEY);
    renderCards();
  }
};

// Init
renderCards();
</script>




</body>
</html>
